/**
 * Autotab - jQuery plugin 1.9.2
 * https://github.com/Mathachew/jquery-autotab
 *
 * Copyright (c) 2008, 2015 Matthew Miller
 *
 * Licensed under the MIT licensing:
 *   http://www.opensource.org/licenses/mit-license.php
 */

!function(e){var t=navigator.platform,a={tabPause:800,focusChange:null,iOS:"iPad"===t||"iPhone"===t||"iPod"===t,firefox:"undefined"!=typeof InstallTrigger,ie11:!window.ActiveXObject&&"ActiveXObject"in window},r=function(t,a){if(null!==a&&"undefined"!=typeof a)for(var r in a)e(t).data("autotab-"+r,a[r])},n=function(t){var a={arrowKey:!1,format:"all",loaded:!1,disabled:!1,pattern:null,uppercase:!1,lowercase:!1,nospace:!1,maxlength:2147483647,target:null,previous:null,trigger:null,originalValue:"",changed:!1,editable:"text"===t.type||"password"===t.type||"textarea"===t.type||"tel"===t.type||"number"===t.type||"email"===t.type||"search"===t.type||"url"===t.type,filterable:"text"===t.type||"password"===t.type||"textarea"===t.type,tabOnSelect:!1};if(e.autotab.selectFilterByClass===!0&&"undefined"==typeof e(t).data("autotab-format")){var n=["all","text","alpha","number","numeric","alphanumeric","hex","hexadecimal","custom"];for(var i in n)if(e(t).hasClass(n[i])){a.format=n[i];break}}for(var i in a)"undefined"!=typeof e(t).data("autotab-"+i)&&(a[i]=e(t).data("autotab-"+i));return a.loaded||(null!==a.trigger&&"string"==typeof a.trigger&&(a.trigger=a.trigger.toString()),r(t,a)),a},i=function(e){return!("undefined"==typeof e||"string"!=typeof e&&e instanceof jQuery)},o=function(e){var t=0,a=0,r=0;if("text"===e.type||"password"===e.type||"textarea"===e.type)if("number"==typeof e.selectionStart&&"number"==typeof e.selectionEnd)t=e.selectionStart,a=e.selectionEnd,r=1;else if(document.selection&&document.selection.createRange){var n=document.selection.createRange(),i=e.createTextRange(),o=e.createTextRange(),l=n.getBookmark();i.moveToBookmark(l),o.setEndPoint("EndToStart",i),t=o.text.length,a=t+n.text.length,r=2}return{start:t,end:a,selectionType:r}};e.autotab=function(t){"object"!=typeof t&&(t={}),e(":input").autotab(t)},e.autotab.selectFilterByClass=!1,e.autotab.next=function(){var t=e(document.activeElement);t.length&&t.trigger("autotab-next")},e.autotab.previous=function(){var t=e(document.activeElement);t.length&&t.trigger("autotab-previous")},e.autotab.remove=function(t){i(t)?e(t).autotab("remove"):e(":input").autotab("remove")},e.autotab.restore=function(t){i(t)?e(t).autotab("restore"):e(":input").autotab("restore")},e.autotab.refresh=function(t){i(t)?e(t).autotab("refresh"):e(":input").autotab("refresh")},e.fn.autotab=function(t,a){if(!this.length)return this;var o=e.grep(this,function(e,t){return"hidden"!=e.type});if("filter"==t){("string"==typeof a||"function"==typeof a)&&(a={format:a});for(var l=0,s=o.length;s>l;l++){var g=n(o[l]),h=a;h.target=g.target,h.previous=g.previous,e.extend(g,h),g.loaded?r(o[l],g):(g.disabled=!0,u(o[l],h))}}else if("remove"==t||"destroy"==t||"disable"==t)for(var l=0,s=o.length;s>l;l++){var g=n(o[l]);g.disabled=!0,r(o[l],g)}else if("restore"==t||"enable"==t)for(var l=0,s=o.length;s>l;l++){var g=n(o[l]);g.disabled=!1,r(o[l],g)}else if("refresh"==t)for(var l=0,s=o.length;s>l;l++){var g=n(o[l]),f=l+1,c=l-1,p=function(){l>0&&s>f?g.target=o[f]:l>0?g.target=null:g.target=o[f]},v=function(){l>0&&s>f?g.previous=o[c]:l>0?g.previous=o[c]:g.previous=null};null===g.target||""===g.target.selector?p():("string"==typeof g.target||g.target.selector)&&(g.target=e("string"==typeof g.target?g.target:g.target.selector),0===g.target.length&&p()),null===g.previous||""===g.previous.selector?v():("string"==typeof g.previous||g.previous.selector)&&(g.previous=e("string"==typeof g.previous?g.previous:g.previous.selector),0===g.previous.length&&v()),g.loaded?(i(g.target)&&(g.target=e(g.target)),i(g.previous)&&(g.previous=e(g.previous)),r(o[l],g)):u(o[l],g)}else if(null===t||"undefined"==typeof t?a={}:"string"==typeof t||"function"==typeof t?a={format:t}:"object"==typeof t&&(a=t),o.length>1)for(var l=0,s=o.length;s>l;l++){var f=l+1,c=l-1,h=a;l>0&&s>f?(h.target=o[f],h.previous=o[c]):l>0?(h.target=null,h.previous=o[c]):(h.target=o[f],h.previous=null),u(o[l],h)}else u(o[0],a);return this};var l=function(e,t,a){if("function"==typeof a.format)return a.format(t,e);var r=null;switch(a.format){case"text":r=new RegExp("[0-9]+","g");break;case"alpha":r=new RegExp("[^a-zA-Z]+","g");break;case"number":case"numeric":r=new RegExp("[^0-9]+","g");break;case"alphanumeric":r=new RegExp("[^0-9a-zA-Z]+","g");break;case"hex":case"hexadecimal":r=new RegExp("[^0-9A-Fa-f]+","g");break;case"custom":r=new RegExp(a.pattern,"g");break;case"all":}return null!==r&&(t=t.replace(r,"")),a.nospace&&(r=new RegExp("[ ]+","g"),t=t.replace(r,"")),a.uppercase&&(t=t.toUpperCase()),a.lowercase&&(t=t.toLowerCase()),t},u=function(t,u){var s=n(t);s.disabled&&(s.disabled=!1,s.target=null,s.previous=null),e.extend(s,u),i(s.target)&&(s.target=e(s.target)),i(s.previous)&&(s.previous=e(s.previous));var g=t.maxLength;return"undefined"==typeof t.maxLength&&"textarea"==t.type&&(g=t.maxLength=t.getAttribute("maxlength")),2147483647==s.maxlength&&2147483647!=g&&-1!=g?s.maxlength=g:s.maxlength>0?t.maxLength=s.maxlength:s.target=null,s.loaded?void r(t,s):(s.loaded=!0,r(t,s),"select-one"==t.type&&e(t).on("change",function(t){var a=n(this);a.tabOnSelect&&e(this).trigger("autotab-next")}),void e(t).on("autotab-next",function(e,t){var r=this;setTimeout(function(){t||(t=n(r));var e=t.target;!t.disabled&&e.length&&(a.iOS||(e.prop("disabled")||e.prop("readonly")?e.trigger("autotab-next"):t.arrowKey?e.focus():e.focus().select(),a.focusChange=new Date))},1)}).on("autotab-previous",function(e,t){var i=this;setTimeout(function(){t||(t=n(i));var e=t.previous;if(!t.disabled&&e.length){var o=e.val();e.prop("disabled")||e.prop("readonly")?e.trigger("autotab-previous"):o.length&&e.data("autotab-editable")&&!t.arrowKey?(a.ie11?e.val(o.substring(0,o.length-1)).focus():e.focus().val(o.substring(0,o.length-1)),r(e,{changed:!0})):(t.arrowKey&&r(this,{arrowKey:!1}),a.ie11?e.val(o).focus():e.focus().val(o)),a.focusChange=null}},1)}).on("focus",function(){r(this,{originalValue:this.value})}).on("blur",function(){var t=n(this);t.changed&&this.value!=t.originalValue&&(r(this,{changed:!1}),e(this).change())}).on("keydown.autotab",function(t){var i=n(this);if(!i||i.disabled)return!0;var l=o(this),u=t.which||t.charCode;if(8==u){if(i.arrowKey=!1,!i.editable)return e(this).trigger("autotab-previous",i),!1;if(r(this,{changed:this.value!==i.originalValue}),0===this.value.length)return void e(this).trigger("autotab-previous",i)}else if(9==u&&null!==a.focusChange){if(t.shiftKey)return void(a.focusChange=null);if((new Date).getTime()-a.focusChange.getTime()<a.tabPause)return a.focusChange=null,!1}else"range"!==this.type&&"select-one"!==this.type&&"select-multiple"!==this.type&&("tel"!==this.type&&"number"!==this.type||("tel"===this.type||"number"===this.type)&&0==this.value.length)&&(37!=u||i.editable&&0!=l.start?39!=u||i.editable&&i.filterable&&l.end!=this.value.length&&0!=this.value.length||(i.arrowKey=!0,e(this).trigger("autotab-next",i)):(i.arrowKey=!0,e(this).trigger("autotab-previous",i)))}).on("keypress.autotab",function(t){var i=n(this),u=t.which||t.keyCode;if(!i||i.disabled||a.firefox&&0===t.charCode||t.ctrlKey||t.altKey||13==u||this.disabled)return!0;var s=String.fromCharCode(u);if("text"!=this.type&&"password"!=this.type&&"textarea"!=this.type)return this.value.length+1>=i.maxlength&&(i.arrowKey=!1,e(this).trigger("autotab-next",i)),!(this.value.length==i.maxlength);if(null!==i.trigger&&i.trigger.indexOf(s)>=0)return null!==a.focusChange&&(new Date).getTime()-a.focusChange.getTime()<a.tabPause?a.focusChange=null:(i.arrowKey=!1,e(this).trigger("autotab-next",i)),!1;a.focusChange=null;var g=document.selection&&document.selection.createRange?!0:u>0;if(s=l(this,s,i),g&&(null===s||""===s))return!1;if(g&&this.value.length<=this.maxLength){var h=o(this);if(0===h.start&&h.end==this.value.length)r(this,{changed:s!=i.originalValue});else{if(this.value.length==this.maxLength&&h.start===h.end)return i.arrowKey=!1,e(this).trigger("autotab-next",i),!1;var f=this.value.slice(0,h.start)+s+this.value.slice(h.end);r(this,{changed:f!=i.originalValue})}if(this.value.length!=i.maxlength)if(h.start++,1==h.selectionType)this.selectionStart=this.selectionEnd=h.start;else if(2==h.selectionType){var c=this.createTextRange();c.collapse(!0),c.moveEnd("character",h.start),c.moveStart("character",h.start),c.select()}}return this.value.length==i.maxlength&&(i.arrowKey=!1,e(this).trigger("autotab-next",i)),!0}).on("drop paste",function(t){var r=n(this);return r?(this.maxLength=2147483647,void function(t,i){setTimeout(function(){var o=-1,u=document.createElement("input");u.type="hidden",u.value=t.value.toLowerCase(),u.originalValue=t.value,e(t).val(l(t,t.value,i).substr(0,i.maxlength)).trigger("change");var s=function(t,r){if(t){var i=n(t);if(e(t).prop("disabled")||e(t).prop("readonly")||!i.editable)return e(t).trigger("autotab-next"),void(a.iOS||s(i.target[0],r));for(var g=0,h=r.length;h>g;g++)o=u.value.indexOf(r.charAt(g).toLowerCase(),o)+1;var f=u.originalValue.substr(o),c=l(t,f,i).substr(0,i.maxlength);c&&(e(t).val(c).trigger("change"),c.length==i.maxlength&&(i.arrowKey=!1,e(t).trigger("autotab-next",i),a.firefox&&setTimeout(function(){t.selectionStart=t.value.length},1),a.iOS||s(i.target[0],c)))}};t.value.length==i.maxlength&&(r.arrowKey=!1,e(t).trigger("autotab-next",r),a.iOS||s(i.target[0],t.value.toLowerCase())),t.maxLength=i.maxlength},1)}(this,r)):!0}))};e.fn.autotab_magic=function(t){return e(this).autotab()},e.fn.autotab_filter=function(t){var a={};return"string"==typeof t||"function"==typeof t?a.format=t:e.extend(a,t),e(this).autotab("filter",a)}}(jQuery);